\documentclass[11pt,a4paper]{report}
 
\usepackage[portuguese]{babel}
\usepackage{indentfirst}
%Em windows
 
\usepackage[latin1]{inputenc} 
\usepackage[T1]{fontenc}
\usepackage[tt]{titlepic}

\usepackage{listings}
\usepackage{graphicx}

\begin{document}

\begin{titlepage}

\begin{center}

\begin{figure}[htp]
  \centering
  \includegraphics{feup}
 
\end{figure}

\vspace{10 mm}

\textsc{\large Mestrado Integrado em Engenharia Informática e Computação} \\
\textsc{\large Agentes e Inteligência Artificial Distribuída} \\
\textsc{\normalsize 4º Ano} \\ 
\vspace{10 mm}
\textsc{\LARGE Determinação de percursos usando agentes BDI} \\
\textsc{\normalsize Relatório Final} \\

% Title
\vspace{30 mm}
% Author and supervisor
\emph{Autores:}\\
Bruno Filipe Neves Ferreira - 080509088 - ei08088@fe.up.pt \\
Carlos Tiago da Rocha Babo - 080509118 - ei08118@fe.up.pt \\
Hélder Alexandre dos Santos Moreira - 080509170 - ei08170@fe.up.pt

\vfill

% Bottom of the page
{\large \today}

\end{center}

\end{titlepage}

\newpage

\tableofcontents
\setcounter{tocdepth}{1}


\chapter{Objetivo}

\section{Descrição do cenário}

Numa viagem de automóvel o condutor tem que tomar várias decisões até chegar ao seu destino. Tendo em mente que o agente condutor pode ter várias intenções sobre o percurso a realizar, a escolha do caminho tem como base essas intenções. \\

Independentemente da intenção do condutor (chegar rapidamente a um local ou realizar um percurso turístico), o agente não conhece antecipadamente as condições do percurso escolhido. Apenas toma conhecimento dessas condições quando estas se encontram no seu campo de visão, ou então quando o rádio informa da ocorrência de um acidente. \\


\section{Objetivos do trabalho}

No âmbito da Unidade Curricular de Agentes e Inteligência Artificial Distribuída, o objetivo deste trabalho é criar um sistema multi-agente que consiga recolher informações sobre o espaço e indicar ao condutor qual o percurso que este deve tomar, tendo em conta os vários estímulos possíveis: acidentes, pontos de interesse, estado do tempo, rádio, entre outros.
O sistema deve avaliar os estímulos (condições do percurso), bem como as condições pré-definidas de modo a que o condutor chegue ao destino do modo pretendido. \\

\chapter{Especificação}

\section{Identificação e caraterização dos agentes}

A aplicação contempla um agente, Driver, e duas \emph{capabilities}, GPS e Rádio. \\

\subsection{GPS}

O GPS contém como \emph{beliefs} o ambiente em que o condutor se encontra, tendo assim a informação sobre vários componentes do espaço, isto é, pontos de interesse, ponto inicial e final da viagem, o mapa de estradas (caminhos possíveis), entre outros. O GPS tem como \emph{goals} mover o condutor, Driver, até um destino a determinar quando recebe um pedido do mesmo e também recalcular a nova rota quando toma conhecimento de um acidente no percurso estabelecido. \\ 

O GPS procura assim nas pontos de interesse nas imediações do agente e encaminha-o para lá. Em caso de acidente, é recalculada a rota para um próximo ponto de interesse e o que iria ser visitado fica guardado para ser visitado novamente. Quando todos os pontos estiverem visitados, ou não houver caminho possível para nenhum outro, o GPS encaminha o agente para o ponto final da viagem. \\

\subsection{Driver}

O agente Driver inclui a \emph{capability} GPS para interagir com a mesma e possui como \emph{beliefs} o próximo ponto turístico para onde se está a dirigir e eventualmente algum acidente que esteja a evitar.  O condutor não tem desta forma acesso aos restantes componentes do espaço, indicando apenas que tipo de viagem pretende realizar (turística, rápida, etc) e deixando as decisões a cabo do GPS, tal como acontece num ambiente real. O agente tem assim como \emph{goals} analisar o seu espaço circundante (radar) e avisar o GPS caso encontre alguma acidente no seu percurso. \\
 
\subsection{Rádio} 
 
A informação relativa aos acidentes é guardada ao nível do Rádio, não sendo assim conhecida previamente nem pelo condutor, nem pelo GPS, e será transmitida ao GPS através da troca de eventos por mensagem com o agente quando o rádio se encontrar ativo ou detetados pelo campo de visão do condutor. \\

\subsection{Aplicação} 

A aplicação recorre às funcionalidades disponibilizadas pelo \emph{Jadex} 2.0 e tem como elemento principal um espaço 2D da classe \emph{ContinuousSpace2D} que aloja vários elementos:

\begin{itemize}

\item {\bf Mapa de estradas} \\
Representa os caminhos onde o condutor pode movimentar-se e será representado pelo meio de arestas. Esta representação tem como objetivo permitir o mapeamento do mapa num grafo, facilitando a determinação de percursos.

\item {\bf Pontos de interesse} \\
São os pontos de interesse que o condutor deve visitar caso faça uma visita turística. Podem conter propriedades específicas, tais como o facto de só permitir visitas num determinado estado atmosférico ou também uma pré-condição para a visita (a visita de outro ponto de interesse por exemplo).

\item {\bf Acidentes}  \\
Representam um obstáculo incontornável na estrada e que obrigará o condutor a procurar outro caminho. Tal como os pontos de interesse, podem conter propriedades específicas de acordo com o estado atmosférico (só se encontra ativo em tempo de chuva por exemplo).

\item {\bf Ponto inicial da viagem}  \\
Representa o ponto inicial da viagem a partir do qual o condutor partirá.

\item {\bf Ponto final da viagem}  \\
Representa o ponto final da viagem para o qual o condutor tem como objetivo dirigir-se.

\end{itemize}

\begin{figure}[htp]
  \centering
  \includegraphics[width=0.8\textwidth]{aplicacao}
  \caption{Esquema representativo da estrutura da aplicação.}
\end{figure}

\section{Protocolos de interação}


\begin{figure}[htp]
  \centering
  \includegraphics[width=0.8\textwidth]{interacao}
  \caption{Esquema representativo das interações entre os vários componentes.}
\end{figure}


Hierarquicamente, o GPS encontra-se numa camada superior ao agente Driver e é esta que, com conhecimento do ambiente e com um pedido do agente, o move até à localização desejada. De acordo com a pesquisa que fizemos sobre a tecnologia \emph{Jadex} e sobre as possíveis abordagens ao problema esta pareceu-nos a mais correta e viável. \\

Assim o processo de interação entre os vários componentes começa pelo agente que comunicará ao GPS a sua intenção de realizar uma viagem e visitar os pontos turísticos conhecidos. O GPS calcula o caminho que o agente deve seguir e move-o de acordo. Ao mover-se o condutor comunicará ao GPS caso encontre algum acidente no seu caminho e este recalculará a nova rota. \\

Caso o modo rádio esteja ativado, este comunica através de eventos por mensagem com o GPS, indicando-lhe os acidentes que estão presentes ao longo do mapa e este terá a responsabilidade de avaliar se os acidentes encontrados interferem no percurso definido para o condutor e caso isso aconteça, recalcular a rota. \\



\chapter{Desenvolvimento}

\section{Ferramentas utilizadas}

O \emph{Jadex} BDI 2.0 é um motor que permite especificar agentes inteligentes baseado no modelo \emph{Belief-Desire-Intention} com recurso a \emph{XML} e Java. Uma das principais vantagens da ferramenta é não introduzir nenhuma linguagem de programação nova, permitindo usar \emph{IDEs} focados no desenvolvimento orientado a objetos, como o \textit{NetBeans}. \\

Para a interface gráfica recorreu-se ao conhecido \textit{Swing}, que permite desenvolver interfaces gráficas em \textit{Java} de forma simples e versátil.

\subsection{Características Principais do Jadex}

Os agentes racionais têm uma representação explícita no ambiente e dos objetivos que estão a tentar atingir. Estes são racionais, pois escolhem sempre a ação mais promissora (de acordo com a base de conhecimento do mundo) para atingir os seus objetivos. Dado que normalmente não têm conhecimento dos efeitos de cada ação previamente, os agentes deliberam sempre sobre as opções disponíveis.\\

Em 1987, Bratman introduziu uma arquitetura para descrever os agentes racionais. Esta  consiste em explorar as atitudes mentais que geram as ações do homem - crenças, desejos e intenções. Assim, as crenças captam as atitudes de informação, os desejos as atitudes de motivação, e as intenções as atitudes de deliberação dos agentes. Mais tarde, Rao e Geoff adotaram este modelo e transformaram-no numa teoria mais formal e num modelo de execução para software de agentes, baseado na noção de crenças, objetivos e planos (\emph{beliefs}, \emph{goals} e \emph{plans}).\\

Deste modo, o \emph{Jadex} reaproveitou o modelo de Rao e Geoff e portou-o para o contexto da programação orientada a objetos. Assim, os \emph{beliefs}, \emph{goals} e \emph{plans} representam objetos de classes que são criadas e manipuladas no contexto de cada agente. Os agentes comportam  \emph{beliefs}, representados por qualquer tipo de objeto Java e que pertencem à sua \emph{beliefbase}. Os \emph{goals} representam motivações concretas (estados a atingir) e que influenciam o comportamento do agente. Para atingir os seus objetivos (\emph{goals}), o agente executa planos (\emph{plans}), que são descritos em Java.\\

Os agentes podem ainda comunicar entre si com recurso a eventos internos (\textit{internalevent}) ou eventos externos (\textit{messageevent}). Os eventos internos permitem que o agente comunique dentro de si. Isto é, se um plano enviar uma notificação interna, todos os outros planos que registaram interesse nesse evento serão notificados. Os eventos externos, também conhecidos por mensagens, permitem enviar e receber mensagens entre agentes. \\ 

Este modelo comporta, desta forma, duas componentes essenciais. Por um lado, o agente reage a mensagens, eventos internos e \emph{goals} selecionando e executando \emph{plans}. Por outro lado, o agente delibera continuamente sobre os seus \emph{goals} atuais, adaptando-se às condições de cada momento.\\


\subsection{Ambiente de desenvolvimento}

O ambiente de desenvolvimento escolhido foi o \textit{NetBeans}, pois é um \textit{IDE} (\textit{Integrated development environment}) com uma excelente integração com o \textit{Swing} e que reconhece a sintaxe \textit{XML} para a declaração de agentes.  \\

Para desenvolver o projeto em \textit{Jadex}, foi descarregada a versão mais recente do \textit{site} oficial (2.0), que inclui as bibliotecas em formato \textit{*.jar} necessárias. \\

\section{Estrutura da aplicação}
\subsection{Módulos da aplicação}
A aplicação é composta por dois grandes módulos. A Interface representa as classes \textit{Java} que implementam a interface externa ao próprio \textit{Jadex}. Nela estão incluídas a janela com o \textit{log} do utilizador e os seus \textit{beliefs}, a janela que permite adicionar novos componentes ao mapa da estrada e a janela que permite começar a simulação e consultar informação relativa ao cenário atual. \\ 

Por outro lado, o módulo da Aplicação contém os agentes, a \textit{capability} GPS e o Mundo - que inclui os pontos de interesse, os acidentes e o mapa de estrada. O Condutor importa a capacidade GPS, que lhe permite movimentar pelo espaço. Por sua vez, é o GPS que tem acesso ao mundo em si, e que lhe permite calcular a rota do condutor. De acordo com a especificação, o GPS não tem acesso aos acidentes \textit{à priori}. Por último, o agente Rádio tem acesso direto aos acidentes ao aceder ao Mundo e comunica-os ao condutor, caso essa opção esteja ativa.\\ 

\begin{figure}[htp]
  \centering
  \includegraphics[width=0.9\textwidth]{components}
  \caption{Esquema representativo dos módulos da aplicação.}
\end{figure}

\subsection{Detalhes revelantes da implementação}

\textbf{Objetos mais utilizados (e referenciados no relatório)}

\begin{itemize}
\item{\textit{ISpaceObject} - representação de um objeto do espaço. Permite aceder a várias informações, nomeadamente o seu \textit{ID}, a sua posição e as suas propriedades.}
\item{\textit{Grid2D} - representação do espaço em si. Permite aceder a todos os objetos, assim como apaga-los ou inserir novos.}
\item{\textit{IVector2} - representação de um vetor (com coordenadas \textit{x} e \textit{y}) do espaço 2D.}
\end{itemize}


Tendo em conta os objetivos do projeto, podemos identificar quatro estruturas principais: o condutos, o GPS, o rádio e o Mundo em si. \\

\textbf{Condutor}

\begin{itemize}
\item{\textit{Beliefs}}

\begin{itemize}
\item{\textit{(ISpaceObject) Myself (referência)} - objeto que o representa no espaço.}
\item{\textit{(ISpaceObject) POI} (ponto de interesse) (referência) - ponto de interesse a visitar atualmente.}
\item{\textit{(ISpaceObject)} Acidente (referência) - acidente a tentar evitar no momento (quando não há nenhum, o belief não contém qualquer informação).}
\item{\textit{(Boolean)} Turística - booleano que permite saber se está em modo turístico ou modo direto.}
\item{\textit{(Boolean)Newradiomsg} - booleano que indica se há alguma mensagem de rádio nova para analisar.}
\end{itemize}

\item{\textit{Goals}}

\begin{itemize}
\item{\textit{AnalyzeAccident} - acionado quando há um novo acidente no campo de visão e é necessário verificar se interfere com o \textit{goal} atual.}
\item{\textit{AnalyzeRadioMsg} - acionado quando há uma nova mensagem de rádio e é necessário verificar se interfere com o \textit{goal} atual.}
\item{\textit{GoDestiny} - acionado no início da execução do agente, pois é este o \textit{goal} principal do agente, chegar ao seu destino final.}
\end{itemize}

\item{\textit{Plans}}

\begin{itemize}
\item{\textit{GoDestiny} - acionado quando há a intenção do agente em ir para uma dada posição.}
\item{\textit{AvoidAccident} - acionado quando há a intenção do agente em evitar um certo acidente, recalculando a rota atual.}
\item{\textit{AccidentInform} - acionado quando há uma mensagem nova do rádio por ler.}
\end{itemize}

\item{\textit{Events}}

\begin{itemize}
\item{\textit{AccidentInform} - registo para a receção de mensagens de rádio com novos acidentes.}
\end{itemize}


\end{itemize}

\textbf{GPS}

\begin{itemize}
\item{Beliefs}

\begin{itemize}
\item{\textit{(ISpaceObject) Myself} - objeto que o representa no espaço.}
\item{\textit{(ISpaceObject) POI} - ponto de interesse a visitar atualmente.}
\item{\textit{(ISpaceObject)} Acidente - acidente a tentar evitar no momento (quando não há nenhum, o \textit{belief} não contém qualquer informação.}
\item{\textit{(Grid2D) Environment} - ambiente em que se insere com a informação dos pontos de interesse e estradas.}
\end{itemize}

\item{Goals}

\begin{itemize}
\item{\textit{MoveDest} - intenção de se deslocar até um dado ponto.}
\end{itemize}

\item{Plans}

\begin{itemize}
\item{\textit{GoDestination} - acionado quando há intenção de calcular a rota para um dado ponto.}
\end{itemize}

\end{itemize}

\textbf{Rádio}

\begin{itemize}
\item{Beliefs}

\begin{itemize}
\item{\textit{(Grid2D) Environment} - ambiente em que se insere com a informação dos acidentes.}
\end{itemize}

\item{Plans}

\begin{itemize}
\item{\textit{InformAccident} - acionado quando é necessário mandar informação relativa a novos acidentes.}
\end{itemize}

\item{\textit{Events}}

\begin{itemize}
\item{\textit{InformAccident} - registo para o envio de mensagens de rádio com a informação de novos acidentes.}
\end{itemize}

\end{itemize}

\textbf{Mundo}

\begin{itemize}
\item{Objetos}

\begin{itemize}
\item{\textit{Driver} - objeto que representa um agente do tipo \textit{Driver}.}
\item{\textit{POI} - objeto que representa os pontos de interesse.}
\item{\textit{Cell} - objeto que no seu conjunto representa as estradas.}
\end{itemize}

\item{Agentes}

\begin{itemize}
\item{\textit{Driver} - agente do tipo condutor.}
\item{\textit{Radio} - agente do tipo rádio.}
\end{itemize}

\end{itemize}

\textbf{Implementação do deslocamento do condutor \\}

Para deslocar o condutor no espaço foi necessário implementar um algoritmo para encontrar o melhor caminho entre dois pontos. Assim, escolheu-se o algoritmo A*, abordado na unidade curricular de Inteligência Artificial. Dada uma matriz e dois pontos, é calculado o caminho mais curto entre eles. Na matriz, as células com caminho são representadas pelo valor um, e as restantes pelo valor zero. \\

Desta forma, a primeira operação a fazer quando surge a intenção de um agente em ir de uma posição para a outra, é calcular o caminho entre essas duas posições. Se existir caminho, é criada uma \textit{Task} (\textit{MoveTask}) que desloca o condutor até à posição pretendida. Esta \textit{Task} é executada a cada \textit{tick} de relógio da aplicação, movimentando o condutor de acordo com a velocidade definida previamente para os objetos do ambiente. \\

Durante a execução desta \textit{Task} é verificado a cada momento se existe algum acidente na área de visão do condutor (também definida para os objetos do ambiente). Ao encontrar um novo acidente ainda não avistado, o conhecimento do condutor é atualizado convenientemente. Tendo em conta que esta movimentação dá-se no espaço em si, o \textit{Jadex} dispões de um acesso externo (\textit{IBDIExternalAccess}) que permite aceder aos \textit{beliefs} do condutor, para atualizados com a nova informação.  \\


\chapter{Experiências}

\section{Objetivo de cada experiência}

\section{Resultados}

\chapter{Conclusões}

\chapter{Melhoramentos}

\chapter{Recursos}
\section{Bibliografia}

\begin{itemize}
\item http://jadex-agents.informatik.uni-hamburg.de
\item http://paginas.fe.up.pt/~eol/AIAD/aiad1112.html
\item http://sourceforge.net/projects/jadex/
\end{itemize}


\section{Software}

\begin{itemize}
\item Eclipse - IDE utilizado para desenvolvimento.
\item Jadex 2.0
\end{itemize}

\section{Elementos do grupo}

\chapter{Apêndice}
\section{Manual do utilizador}

\end{document}